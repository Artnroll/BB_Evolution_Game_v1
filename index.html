<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Unity WebGL Player | BitBullz Evolution</title>
    <link rel="shortcut icon" href="TemplateData/favicon.ico">
    <link rel="stylesheet" href="TemplateData/style.css">
    <link rel="manifest" href="manifest.webmanifest">
</head>
<body>
    <div id="unity-container">
        <canvas id="unity-canvas" width=512 height=1024 tabindex="-1"></canvas>
        <div id="unity-loading-bar">
            <div id="unity-logo"></div>
            <div id="unity-progress-bar-empty">
                <div id="unity-progress-bar-full"></div>
            </div>
        </div>
        <div id="unity-warning"> </div>
    </div>
    <script src="index.js"></script>
    <script>
        function sendTelegramUsernameToUnity() {
            if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.initDataUnsafe.user) {
                const tgUser = window.Telegram.WebApp.initDataUnsafe.user;
                const username = tgUser.username || tgUser.first_name || ("user_" + tgUser.id);

                // Send to Unity
                if (typeof gameInstance !== "undefined") {
                    gameInstance.SendMessage('GameProgressManager', 'SetUsernameFromTelegram', username);
                } else {
                    console.log("gameInstance not defined yet");
                }
            } else {
                console.log("Telegram user data not available");
            }
        }

        // Run as soon as the WebApp is ready
        window.Telegram.WebApp.ready();
        sendTelegramUsernameToUnity();
    </script>

    <script src="index.js"></script>
</body>
</html>
